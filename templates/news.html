<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Market News</title>
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet"/>
  <style>
      body {
          background-image: url('/static/images/market_news.jpg');
          background-size: cover;
          background-position: center;
          background-repeat: no-repeat;
          background-attachment: fixed;
      }
      .card {
          background-color: rgba(255, 255, 255, 0.8); /* White with 80% opacity */
          border: none;
          box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }
      .card-title a {
          color: #083b72;
          text-decoration: none;
      }
      .card-title a:hover {
          text-decoration: underline;
      }
      .card-text {
          color: #333;
      }
      .card-text a {
          color: #007bff;
          text-decoration: none;
      }
      .card-text a:hover {
          text-decoration: underline;
          color: #0056b3;
      }
      /* Add these styles to your existing CSS */
      .nav-tabs {
          background-color: rgba(240, 240, 240, 0.8);
          padding: 10px 10px 0 10px;
          border-radius: 8px 8px 0 0;
      }

      .nav-pills {
          background-color: rgba(230, 240, 255, 0.8);
          padding: 10px;
          border-radius: 5px;
          margin-bottom: 15px;
      }

      .tab-content {
          background-color: rgba(255, 255, 255, 0.3);
          padding: 20px;
          border-radius: 0 0 8px 8px;
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .navbar-datetime {
          font-weight: 500;
          margin-right: 15px;
          padding: 8px 15px;
          background-color: rgba(255, 255, 255, 0.1);
          border-radius: 4px;
      }
      h2 {
          color: #000000;
          background-color: rgba(255, 255, 255, 0.5);
          margin-bottom: 20px;
          background-position: center;
          position: center;
      }
      .nav-link {
          color: #083b72;
      }
      .nav-link.active {
          background-color: #083b72;
          color: white;
      }
      .nav-link:hover {
          background-color: #0056b3;
          color: white;
      }
      .tab-content {
          background-color: rgba(255, 255, 255, 0.3);
          padding: 20px;
          border-radius: 0 0 8px 8px;
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .navbar-datetime {
          font-weight: 500;
          margin-right: 15px;
          padding: 8px 15px;
          background-color: rgba(255, 255, 255, 0.1);
        }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <div class="container-fluid">
          <a class="navbar-brand" href="{{ url_for('home') }}">Stock Analysis</a>
          <div class="navbar-nav ml-auto">
              <span class="navbar-datetime" id="datetime"></span>
              <a class="nav-link" href="{{ url_for('home') }}">Home</a>
              <a class="nav-link" href="{{ url_for('news') }}">Market News</a>
          </div>
      </div>
  </nav>
  <div class="container-fluid mt-4">
    <h2 class="text-center mb-4">News</h2>
    <!-- Publisher Tabs -->
    <ul class="nav nav-tabs" id="publisherTab" role="tablist">
        {% for publisher in publishers %}
        <li class="nav-item">
            <a class="nav-link {% if loop.first %}active{% endif %}" 
               id="{{ publisher }}-tab" 
               data-toggle="tab" 
               href="#{{ publisher }}" 
               role="tab">{{ publisher }}</a>
        </li>
        {% endfor %}
    </ul>

    <!-- Publisher Content -->
    <div class="tab-content" id="publisherTabContent">
        {% for publisher in publishers %}
        <div class="tab-pane fade {% if loop.first %}show active{% endif %}" 
             id="{{ publisher }}" 
             role="tabpanel">
            
            <!-- Category Tabs -->
            <ul class="nav nav-pills mt-3" id="categoryTab-{{ publisher }}" role="tablist">
                {% for category in categories %}
                <li class="nav-item">
                    <a class="nav-link {% if loop.first %}active{% endif %}"
                       id="{{ publisher }}-{{ category }}-tab"
                       data-toggle="pill"
                       href="#{{ publisher }}-{{ category }}"
                       role="tab">
                       {{ category }}
                       {% if not organized_news.get(publisher, {}).get(category, []) %}
                           <span class="badge badge-secondary ml-1">0</span>
                       {% else %}
                           <span class="badge badge-primary ml-1">{{ organized_news[publisher][category]|length }}</span>
                       {% endif %}
                    </a>
                </li>
                {% endfor %}
            </ul>

            <!-- Category Content -->
            <div class="tab-content" id="categoryTabContent-{{ publisher }}">
                {% for category in categories %}
                <div class="tab-pane fade {% if loop.first %}show active{% endif %}"
                     id="{{ publisher }}-{{ category }}"
                     role="tabpanel">
                    {% if organized_news.get(publisher, {}).get(category, []) %}
                        <div class="row mt-3">
                            {% for item in organized_news[publisher][category] %}
                            <div class="col-2-4 mb-4">
                                <div class="card h-100">
                                    <div class="card-body">
                                        <h5 class="card-title">
                                            <a href="{{ item.link }}" target="_blank">{{ item.title }}</a>
                                        </h5>
                                        <p class="card-text">
                                            <small class="text-muted">{{ item.published_at }}</small>
                                        </p>
                                        <p class="card-text">{{ item.description }}</p>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <div class="d-flex justify-content-center align-items-center mt-5">
                            <div class="text-center">
                                <i class="fas fa-newspaper fa-3x text-muted mb-3"></i>
                                <h4 class="text-muted">No news available in {{ category }}</h4>
                            </div>
                        </div>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<style>
    /* Other existing styles remain the same */
    
    /* Add custom column width for 5 equal columns */
    .col-2-4 {
        -webkit-box-flex: 0;
        -ms-flex: 0 0 20%;
        flex: 0 0 20%;
        max-width: 20%;
        position: relative;
        width: 100%;
        padding-right: 15px;
        padding-left: 15px;
    }
    
    /* Make cards more compact for better fit */
    .card {
        margin: 0 5px;
    }
    
    /* Adjust card title font size */
    .card-title {
        font-size: 0.9rem;
    }
    
    /* Adjust card text font size */
    .card-text {
        font-size: 0.8rem;
    }
</style></div></div></div>  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
</body>
</html>

<script>
function updateDateTime() {
    const now = new Date();
    const options = { 
        weekday: 'short', 
        year: 'numeric', 
        month: 'short', 
        day: 'numeric',
        hour: '2-digit', 
        minute: '2-digit',
    };
    document.getElementById('datetime').innerHTML = now.toLocaleString('en-US', options);
}

// Update immediately and then every second
updateDateTime();
setInterval(updateDateTime, 1000);
</script>
